"use strict";(self.webpackChunkmy_webpack_vue=self.webpackChunkmy_webpack_vue||[]).push([[490],{8325:(t,e,i)=>{i.r(e),i.d(e,{default:()=>C});var n=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"three"},[n("ModelFbx",{attrs:{src:t.modelUrl,lights:t.lights,scale:t.scale,sceneBg:t.BG}}),t._v(" "),n("div",{staticClass:"title"},[n("div",{staticClass:"content"},[n("div",{staticClass:"_title"},[t._v(t._s(t.modelText.title))]),t._v(" "),t.showTip?t._e():n("div",[n("img",{staticClass:"pointer",attrs:{src:i(693),alt:""},on:{click:function(e){t.showTip=!0}}})]),t._v(" "),t.showTip?n("div",[n("div",{staticClass:"_sub-title"},[t._v(t._s(t.modelText.subTitle))]),t._v(" "),n("div",[n("img",{staticClass:"pointer",attrs:{src:i(9389),alt:""},on:{click:function(e){t.showTip=!1}}})])]):t._e()])]),t._v(" "),t._m(0),t._v(" "),n("div",{staticClass:"action"},[n("img",{staticClass:"auto-icon",attrs:{src:i(4828),alt:""},on:{click:function(e){return t.modelAuto()}}}),t._v(" "),n("img",{staticClass:"help-icon",attrs:{src:i(3421),alt:""},on:{click:function(e){t.dialogVisible=!0}}})]),t._v(" "),n("div",{staticClass:"close pointer"},[n("img",{attrs:{src:i(2266),alt:""},on:{click:function(e){return t.close()}}})]),t._v(" "),n("Tutorial",{model:{value:t.dialogVisible,callback:function(e){t.dialogVisible=e},expression:"dialogVisible"}})],1)},o=[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"logo"},[e("img",{attrs:{src:i(4427),alt:""}})])}];n._withStripped=!0;var s=i(6927),r=i(3458),a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{width:"100%",height:"100%",margin:"0",border:"0",padding:"0"}},[t.suportWebGL?i("canvas",{ref:"canvas",staticStyle:{width:"100%",height:"100%"}}):i("div",[t._t("default",(function(){return[t._v("\n      Your browser does not seem to support "),i("a",{staticStyle:{color:"#000"},attrs:{href:"http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation"}},[t._v("WebGL")]),t._v("."),i("br"),t._v("'\n    ")]}))],2)])};a._withStripped=!0;var c=i(1855),l=i(1012),h=i(7037),u=new l.ZzF;var d=function(){try{var t=document.createElement("canvas");return!(!window.WebGLRenderingContext||!t.getContext("webgl")&&!t.getContext("experimental-webgl"))}catch(t){return!1}}(),p={antialias:!0,alpha:!0};const m={props:{src:{type:String},width:{type:Number},height:{type:Number},position:{type:Object,default:function(){return{x:0,y:0,z:0}}},rotation:{type:Object,default:function(){return{x:0,y:0,z:0}}},scale:{type:Object,default:function(){return{x:1,y:1,z:1}}},lights:{type:Array,default:function(){return[]}},cameraPosition:{type:Object,default:function(){return{x:0,y:0,z:0}}},cameraRotation:{type:Object,default:function(){return{x:0,y:0,z:0}}},cameraUp:{type:Object},cameraLookAt:{type:Object},sceneBg:{type:String,default:""},backgroundColor:{default:16777215},backgroundAlpha:{type:Number,default:1},controlsOptions:{type:Object},crossOrigin:{default:"anonymous"},requestHeader:{default:function(){}},outputEncoding:{type:Number,default:l.rnI},glOptions:{type:Object}},data:function(){return{suportWebGL:d,size:{width:this.width,height:this.height},object:null,raycaster:new l.iMs,mouse:new l.FM8,camera:new l.cPb(45,1,.01,1e5),scene:new l.xsS,wrapper:new l.Tme,renderer:null,controls:null,allLights:[],clock:"undefined"==typeof performance?Date:performance,reqId:null}},computed:{hasListener:function(){var t=this._events,e={};return["on-mousemove","on-mouseup","on-mousedown","on-click"].forEach((function(i){e[i]=!!t[i]&&t[i].length>0})),e}},mounted:function(){void 0!==this.width&&void 0!==this.height||(this.size={width:this.$el.offsetWidth,height:this.$el.offsetHeight});var t=Object.assign({},p,this.glOptions,{canvas:this.$refs.canvas});this.renderer=new l.CP7(t),this.renderer.shadowMap.enabled=!0,this.renderer.outputEncoding=this.outputEncoding,this.controls=new h.z(this.camera,this.$el),this.controls.type="orbit",this.scene.add(this.wrapper),this.load(),this.update();var e=new l.Iis(3);this.scene.add(e),this.sceneBg&&(this.scene.background=(new l.dpR).load(this.sceneBg)),this.$el.addEventListener("mousedown",this.onMouseDown,!1),this.$el.addEventListener("mousemove",this.onMouseMove,!1),this.$el.addEventListener("mouseup",this.onMouseUp,!1),this.$el.addEventListener("click",this.onClick,!1),window.addEventListener("resize",this.onResize,!1),this.animate()},beforeDestroy:function(){cancelAnimationFrame(this.reqId),this.renderer.dispose(),this.controls&&this.controls.dispose(),this.$el.removeEventListener("mousedown",this.onMouseDown,!1),this.$el.removeEventListener("mousemove",this.onMouseMove,!1),this.$el.removeEventListener("mouseup",this.onMouseUp,!1),this.$el.removeEventListener("click",this.onClick,!1),window.removeEventListener("resize",this.onResize,!1)},watch:{src:function(){this.load()},rotation:{deep:!0,handler:function(t){this.object&&this.object.rotation.set(t.x,t.y,t.z)}},position:{deep:!0,handler:function(t){this.object&&this.object.position.set(t.x,t.y,t.z)}},scale:{deep:!0,handler:function(t){this.object&&this.object.scale.set(t.x,t.y,t.z)}},lights:{deep:!0,handler:function(){this.updateLights()}},size:{deep:!0,handler:function(){this.updateCamera(),this.updateRenderer()}},controlsOptions:{deep:!0,handler:function(){this.updateControls()}},backgroundAlpha:function(){this.updateRenderer()},backgroundColor:function(){this.updateRenderer()}},methods:{getFitScaleValue:function(t){var e=new l.fQA(t);e.geometry.computeBoundingBox();var i=e.geometry.boundingBox,n=Math.max(i.max.x-i.min.x,i.max.y-i.min.y,i.max.z-i.min.z);return this.camera.position.z/n},setScaleToFitSize:function(t){var e=.42*this.getFitScaleValue(t);return t.scale.set(e,e,e),e},ModelAutoCenter:function(t){var e=new l.ZzF;e.expandByObject(t);var i=new l.Pa4;e.getCenter(i),t.position.x=t.position.x-i.x,t.position.y=t.position.y-i.y,t.position.z=t.position.z-i.z},onResize:function(){var t=this;void 0!==this.width&&void 0!==this.height||this.$nextTick((function(){t.size={width:t.$el.offsetWidth,height:t.$el.offsetHeight}}))},onMouseDown:function(t){if(this.hasListener["on-mousedown"]){var e=this.pick(t.clientX,t.clientY);this.$emit("on-mousedown",e)}},onMouseMove:function(t){if(this.hasListener["on-mousemove"]){var e=this.pick(t.clientX,t.clientY);this.$emit("on-mousemove",e)}},onMouseUp:function(t){if(this.hasListener["on-mouseup"]){var e=this.pick(t.clientX,t.clientY);this.$emit("on-mouseup",e)}},onClick:function(t){if(this.hasListener["on-click"]){var e=this.pick(t.clientX,t.clientY);this.$emit("on-click",e)}},pick:function(t,e){if(!this.object)return null;var i=this.$el.getBoundingClientRect();t-=i.left,e-=i.top,this.mouse.x=t/this.size.width*2-1,this.mouse.y=-e/this.size.height*2+1,this.raycaster.setFromCamera(this.mouse,this.camera);var n=this.raycaster.intersectObject(this.object,!0);return(n&&n.length)>0?n[0]:null},update:function(){this.updateRenderer(),this.updateCamera(),this.updateLights(),this.updateControls()},updateModel:function(){var t=this.object;if(t){this.position,this.rotation,this.scale;this.setScaleToFitSize(t),this.ModelAutoCenter(t)}},updateRenderer:function(){var t=this.renderer;t.setSize(this.size.width,this.size.height),t.setPixelRatio(window.devicePixelRatio||1),t.setClearColor(new l.Ilk(this.backgroundColor).getHex()),t.setClearAlpha(this.backgroundAlpha)},updateCamera:function(){var t=this.camera,e=this.object;if(t.aspect=this.size.width/this.size.height,t.updateProjectionMatrix(),this.cameraLookAt||this.cameraUp)t.position.set(this.cameraPosition.x,this.cameraPosition.y,this.cameraPosition.z),t.rotation.set(this.cameraRotation.x,this.cameraRotation.y,this.cameraRotation.z),t.up.set(this.cameraUp.x,this.cameraUp.y,this.cameraUp.z),t.lookAt(new l.Pa4(this.cameraLookAt.x,this.cameraLookAt.y,this.cameraLookAt.z));else{if(!e)return;var i=function(t){return u.setFromObject(t),u.getSize(new l.Pa4)}(e).length();t.position.set(this.cameraPosition.x,this.cameraPosition.y,this.cameraPosition.z),t.rotation.set(this.cameraRotation.x,this.cameraRotation.y,this.cameraRotation.z),0===this.cameraPosition.x&&0===this.cameraPosition.y&&0===this.cameraPosition.z&&(t.position.z=i),t.lookAt(new l.Pa4)}},updateLights:function(){var t,e=this;(t=this.scene).remove.apply(t,(0,c.Z)(this.allLights)),this.allLights=[],this.lights.forEach((function(t){if(t.type){var i=t.type.toLowerCase(),n=null;if("ambient"===i||"ambientlight"===i){var o=0===t.color?t.color:t.color||4210752,s=0===t.intensity?t.intensity:t.intensity||1;n=new l.Mig(o,s)}else if("point"===i||"pointlight"===i){var r=0===t.color?t.color:t.color||16777215,a=0===t.intensity?t.intensity:t.intensity||1,c=t.distance||0,h=0===t.decay?t.decay:t.decay||1;n=new l.cek(r,a,c,h),t.position&&n.position.copy(t.position)}else if("directional"===i||"directionallight"===i){var u=0===t.color?t.color:t.color||16777215,d=0===t.intensity?t.intensity:t.intensity||1;n=new l.Ox3(u,d),t.position&&n.position.copy(t.position),t.target&&n.target.copy(t.target)}else if("hemisphere"===i||"hemispherelight"===i){var p=0===t.skyColor?t.skyColor:t.skyColor||16777215,m=0===t.groundColor?t.groundColor:t.groundColor||16777215,f=0===t.intensity?t.intensity:t.intensity||1;n=new l.vmT(p,m,f),t.position&&n.position.copy(t.position)}e.allLights.push(n),e.scene.add(n)}}))},updateControls:function(){this.controlsOptions&&Object.assign(this.controls,this.controlsOptions)},load:function(){var t=this;this.src&&(this.object&&this.wrapper.remove(this.object),this.loader.setRequestHeader(this.requestHeader),this.loader.load(this.src,(function(){var e=t.getObject.apply(t,arguments);t.process&&t.process(e),t.addObject(e),t.$emit("on-load")}),(function(e){t.$emit("on-progress",e)}),(function(e){t.$emit("on-error",e)})))},getObject:function(t){return t},addObject:function(t){var e=function(t){return u.setFromObject(t),u.getCenter(new l.Pa4)}(t);this.wrapper.position.copy(e.negate()),this.object=t,this.wrapper.add(t),this.updateCamera(),this.updateModel()},animate:function(){this.reqId=requestAnimationFrame(this.animate),this.render()},render:function(){this.renderer.render(this.scene,this.camera)}}};var f=i(5471),v=(0,f.Z)(m,a,[],!1,null,null,null);v.options.__file="src/components/model/model-mixin.vue";const g={name:"model-fbx",mixins:[v.exports],props:{lights:{type:Array,default:function(){return[{type:"HemisphereLight",position:{x:0,y:1,z:0},skyColor:16777215,groundColor:16777215,intensity:.8},{type:"DirectionalLight",position:{x:1,y:1,z:1},color:16777215,intensity:.8}]}}},data:function(){return{loader:new r.y}},methods:{getObject:function(t){return this.animations=t.animations,t}}};var y=(0,f.Z)(g,undefined,undefined,!1,null,null,null);y.options.__file="src/components/model/model-fbx.vue";const b=y.exports;var w=i(8496);const x={name:"",components:{ModelFbx:b,Tutorial:s.Z},data:function(){return{BG:w,scale:{x:.5,y:.5,z:.5},baseUrl:"static/models/",modelUrl:"",lights:[{type:"AmbientLight",color:"0xffffff",intensity:1},{type:"DirectionalLight",position:{x:80,y:100,z:50},color:16777215,intensity:1}],modelText:{title:"",subTitle:"这是一个古董"},showTip:!0,dialogVisible:!1}},methods:{},watch:{$route:{handler:function(t,e){var i=this.baseUrl;t.query.name?(this.modelUrl="".concat(i).concat(t.query.name,".fbx"),this.modelText.title=t.query.name):this.$message.warning("请输入模型名称")},deep:!0,immediate:!0}}};var k=(0,f.Z)(x,n,o,!1,null,"67b53ece",null);k.options.__file="src/views/sdt.vue";const C=k.exports},8496:(t,e,i)=>{t.exports=i.p+"static/images/8e4fe26be1ecf22c0d5d.jpg"}}]);
//# sourceMappingURL=chunk-7a0bb8889c19c4963854.js.map